# HTTP Packet Manipulation with netfilterqueue and scapy

This Python script allows you to manipulate HTTP packets using the `netfilterqueue` library to intercept and modify packets in real-time, and the `scapy` library for packet inspection and modification.

## Prerequisites

Before running the script, ensure you have the following installed:

- Python 3.x
- `netfilterqueue` library: You can install it using `pip install netfilterqueue`.
- `scapy` library: You can install it using `pip install scapy`.

## Usage

1. Ensure that you have the necessary libraries installed as mentioned in the Prerequisites section.

2. Run the script with root privileges since it requires access to network packets:

   ```bash
   sudo python packet_manipulation.py
   ```

3. The script will listen for HTTP packets and capture them in a netfilter queue (queue number 0).

4. When an HTTP packet containing `.exe` in its payload is detected, the script will intercept the HTTP response and modify it to redirect the user to a custom download link.

## How it works

1. The script uses `netfilterqueue` to create a netfilter queue and bind a callback function to it.

2. When an HTTP packet is captured, the script uses `scapy` to inspect its contents.

3. If the packet is an HTTP request (destination port 80) and contains `.exe` in its payload, it records the TCP ACK number in a list.

4. If the packet is an HTTP response (source port 80) and its TCP SEQ number matches a previously recorded TCP ACK number, it means it's a response to an `.exe` request. The script then modifies the response to send a 301 Moved Permanently status code and a custom download link.

5. The modified packet is sent back to the client to redirect them to the custom download link.

## Important Notes

- This script is for educational and demonstration purposes only. Please use it responsibly and with proper authorization from the network owner. Unauthorized interception and manipulation of network traffic may be illegal and unethical.

- The script is set to redirect to a placeholder download link `http://mytargetdownloadlinkhhere.com/download.exe`. You should change this link to the actual URL you want to redirect users to.

- The script uses the `netfilterqueue` library, which requires root privileges to access network packets. Always run the script with `sudo` to avoid permission errors.

- Keep in mind that HTTPS traffic cannot be manipulated with this script directly since HTTPS provides encryption and integrity verification. Modifying HTTPS traffic would require more complex and advanced techniques, and such manipulation is generally not recommended.

## Acknowledgments

- This script was created using the `netfilterqueue` and `scapy` libraries, which provide powerful packet manipulation capabilities in Python.

- The script is inspired by security research and penetration testing techniques, highlighting the importance of securing HTTP traffic and avoiding downloading files from untrusted sources.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

Feel free to modify and enhance the README file according to your specific use case or add any relevant information.
